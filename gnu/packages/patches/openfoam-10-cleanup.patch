From 1b4e0c3aef5e9ac010a5fbe20a9142ef3a1b2a55 Mon Sep 17 00:00:00 2001
From: Reza Housseini <reza.housseini@gmail.com>
Date: Mon, 21 Nov 2022 21:58:04 +0100
Subject: [PATCH] build: change installation directory

---
 applications/test/Distribution2/createGraphs  |   2 +-
 .../Test-rigidBodyDynamics.C                  |   2 +-
 bin/foamMonitor                               |   4 +-
 bin/tools/HookFunctions                       |   2 +-
 etc/bashrc                                    |   2 +
 etc/config.sh/CGAL                            |  19 +-
 etc/config.sh/gperftools                      |   9 +-
 etc/config.sh/metis                           |   4 +-
 etc/config.sh/mpi                             | 233 +-----------------
 etc/config.sh/scotch                          |   4 +-
 etc/config.sh/settings                        |   3 +
 .../decompose/ptscotchDecomp/Make/options     |   3 +-
 .../decompose/scotchDecomp/Make/options       |   2 -
 .../graph/writers/gnuplotGraph/gnuplotGraph.H |   2 +-
 .../writers/gnuplot/gnuplotSetWriter.H        |   2 +-
 .../waterAndIsopropanolEvaporation/Allrun     |   2 +-
 .../waterEvaporation/Allrun                   |   2 +-
 .../binaryBreakup/validation/createGraphs     |   4 +-
 .../breakup/validation/createGraphs           |   4 +-
 .../coalescence/validation/createGraphs       |   4 +-
 .../drift/validation/createGraphs             |   4 +-
 .../isothermalGrowth/validation/createGraphs  |   4 +-
 .../negativeDrift/validation/createGraphs     |   4 +-
 .../validation/createGraphs                   |   4 +-
 .../thermal/waterEvaporation/Allrun           |   2 +-
 .../chemFoam/gri/validation/createGraph       |   4 +-
 .../chemFoam/h2/validation/createGraph        |   4 +-
 .../chemFoam/ic8h18/validation/createGraph    |   4 +-
 .../ic8h18_TDAC/validation/createGraph        |   4 +-
 .../chemFoam/nc7h16/validation/createGraph    |   4 +-
 .../laminar/helmholtzResonance/Allrun         |   2 +-
 .../buoyantCavity/validation/createGraphs     |   6 +-
 .../boundaryWallFunctionsProfile/Allrun       |   4 +-
 .../pimpleFoam/RAS/ballValve/createGraphs     |   4 +-
 .../laminar/nonConformalChannel/Allrun        |   2 +-
 .../planarPoiseuille/validation/createGraph   |   4 +-
 .../simpleFoam/T3A/validation/createGraphs    |   4 +-
 .../roomResidenceTime/validation/Allrun       |   2 +-
 tutorials/mesh/snappyHexMesh/iglooWithFridges |   2 +-
 .../RAS/Grossetete/validation/createGraphs    |   4 +-
 .../RAS/bubblePipe/validation/createGraphs    |   6 +-
 .../RAS/pipeBend/validation/createGraphs      |   6 +-
 .../RAS/wallBoiling/validation/createGraphs   |   4 +-
 .../wallBoilingIATE/validation/createGraphs   |   4 +-
 .../validation/createGraphs                   |   4 +-
 .../validation/createGraphs                   |   4 +-
 .../titaniaSynthesis/validation/createGraphs  |   6 +-
 .../validation/createGraphs                   |   6 +-
 wmake/rules/General/CGAL                      |   4 +-
 wmake/rules/linux64Gcc/c++                    |   4 +-
 50 files changed, 98 insertions(+), 331 deletions(-)

diff --git a/applications/test/Distribution2/createGraphs b/applications/test/Distribution2/createGraphs
index bbcb522f0..58b9c0388 100755
--- a/applications/test/Distribution2/createGraphs
+++ b/applications/test/Distribution2/createGraphs
@@ -1,6 +1,6 @@
 #!/bin/sh
 
-gnuplot<<EOF
+$GNUPLOT<<EOF
     set terminal postscript eps color enhanced font "Helvetica,15"
     set output 'comparison.eps'
     set multiplot layout 2, 1
diff --git a/applications/test/rigidBodyDynamics/Test-rigidBodyDynamics.C b/applications/test/rigidBodyDynamics/Test-rigidBodyDynamics.C
index c13edfe73..1b2dbe689 100644
--- a/applications/test/rigidBodyDynamics/Test-rigidBodyDynamics.C
+++ b/applications/test/rigidBodyDynamics/Test-rigidBodyDynamics.C
@@ -98,7 +98,7 @@ int main(int argc, char *argv[])
     }
     dataFile<< endl;
     animationFile
-        << "#!/usr/bin/env gnuplot" << endl << endl
+        << "$GNUPLOT" << endl << endl
         << "$data << end" << endl;
 
     // Run the RBD simulation
diff --git a/bin/foamMonitor b/bin/foamMonitor
index 32b62d792..def3d902a 100755
--- a/bin/foamMonitor
+++ b/bin/foamMonitor
@@ -98,7 +98,7 @@ title="Data Monitoring"
 size=""
 gpterminal='x11 1 font "helvetica,17" linewidth 1.5 persist noraise'
 
-command -v gnuplot >/dev/null 2>&1 || error "Gnuplot not installed"
+command -v $GNUPLOT >/dev/null 2>&1 || error "Gnuplot not installed"
 
 # parse options
 while [ "$#" -gt 0 ]
@@ -197,7 +197,7 @@ done
 plotFileFooter >> "$gp_file"
 
 touch "$file"
-gnuplot "$gp_file" &
+$GNUPLOT "$gp_file" &
 pid=$!
 
 while true
diff --git a/bin/tools/HookFunctions b/bin/tools/HookFunctions
index 47af55043..193e4fc03 100644
--- a/bin/tools/HookFunctions
+++ b/bin/tools/HookFunctions
@@ -391,7 +391,7 @@ checkBanner() # scope, files...
                         errorMessages+=("$file")
                     fi
                     ;;
-                (''|awk|csh|gnuplot|sed|sh)
+                (''|awk|csh|$GNUPLOT|sed|sh)
                     if ! git show $scopeShow"$file" | pcregrep -q -M "$scriptBanner"
                     then
                         ((++errorCount))
diff --git a/etc/bashrc b/etc/bashrc
index 663993951..7eb980000 100644
--- a/etc/bashrc
+++ b/etc/bashrc
@@ -229,3 +229,5 @@ unset cleaned foamClean foamOldDirs
 [ "$BASH" ] && . $WM_PROJECT_DIR/etc/config.sh/bash_completion
 
 #------------------------------------------------------------------------------
+
+export GNUPLOT = gnuplot
diff --git a/etc/config.sh/CGAL b/etc/config.sh/CGAL
index 0fec802a0..d80278bcb 100644
--- a/etc/config.sh/CGAL
+++ b/etc/config.sh/CGAL
@@ -39,22 +39,7 @@
 #
 #------------------------------------------------------------------------------
 
-boost_version=boost-system
-#boost_version=boost-1.55.0
-#boost_version=boost-1.72.0
-
-cgal_version=cgal-system
-#cgal_version=CGAL-4.10
-#cgal_version=CGAL-5.0.2
-
-if [ "$boost_version" != "boost-system" ]
-then
-    export BOOST_ARCH_PATH=$WM_THIRD_PARTY_DIR/$boost_version
-fi
-
-if [ "$cgal_version" != "cgal-system" ]
-then
-    export CGAL_ARCH_PATH=$WM_THIRD_PARTY_DIR/$cgal_version
-fi
+export CGAL_ARCH_PATH=$CGAL_ROOT
+export BOOST_ARCH_PATH=$BOOST_ROOT
 
 #------------------------------------------------------------------------------
diff --git a/etc/config.sh/gperftools b/etc/config.sh/gperftools
index f9cdb8533..41aea7802 100644
--- a/etc/config.sh/gperftools
+++ b/etc/config.sh/gperftools
@@ -29,13 +29,6 @@
 #
 #------------------------------------------------------------------------------
 
-version=svn
-gperftools_install=$WM_THIRD_PARTY_DIR/platforms/$WM_ARCH$WM_COMPILER
-
-GPERFTOOLS_VERSION=gperftools-$version
-GPERFTOOLS_ARCH_PATH=$gperftools_install/$GPERFTOOLS_VERSION
-
-export PATH=$GPERFTOOLS_ARCH_PATH/bin:$PATH
-export LD_LIBRARY_PATH=$GPERFTOOLS_ARCH_PATH/lib:$LD_LIBRARY_PATH
+export GPERFTOOLS_ARCH_PATH=$GPERFTOOLS_ROOT
 
 #------------------------------------------------------------------------------
diff --git a/etc/config.sh/metis b/etc/config.sh/metis
index 40ef6aa0f..d04d5ea32 100644
--- a/etc/config.sh/metis
+++ b/etc/config.sh/metis
@@ -34,7 +34,7 @@
 #
 #------------------------------------------------------------------------------
 
-export METIS_VERSION=metis-5.1.0
-export METIS_ARCH_PATH=$WM_THIRD_PARTY_DIR/platforms/$WM_ARCH$WM_COMPILER$WM_PRECISION_OPTION$WM_LABEL_OPTION/$METIS_VERSION
+export METIS_VERSION=metis-$METISVERSION
+export METIS_ARCH_PATH=$METIS_ROOT
 
 #------------------------------------------------------------------------------
diff --git a/etc/config.sh/mpi b/etc/config.sh/mpi
index b368cc51a..79efff92d 100644
--- a/etc/config.sh/mpi
+++ b/etc/config.sh/mpi
@@ -30,234 +30,21 @@
 #
 #------------------------------------------------------------------------------
 
-unset MPI_ARCH_PATH MPI_HOME FOAM_MPI_LIBBIN
+export FOAM_MPI=openmpi-$OPENMPIVERSION
+# Optional configuration tweaks:
+_foamSource `$WM_PROJECT_DIR/bin/foamEtcFile config.sh/openmpi`
 
-case "$WM_MPLIB" in
-SYSTEMOPENMPI)
-    # Use the system installed openmpi, get library directory via mpicc
-    export FOAM_MPI=openmpi-system
+export MPI_ARCH_PATH=$OPENMPI_ROOT
 
-    # Undefine OPAL_PREFIX if set to one of the paths on foamOldDirs
-    if [ -z "$($foamClean "$OPAL_PREFIX" "$foamOldDirs")" ]
-    then
-        unset OPAL_PREFIX
-    fi
+# Tell OpenMPI where to find its install directory
+export OPAL_PREFIX=$MPI_ARCH_PATH
 
-    libDir=`mpicc --showme:link | sed -e 's/.*-L\([^ ]*\).*/\1/'`
+_foamAddPath    $MPI_ARCH_PATH/bin
 
-    # Bit of a hack: strip off 'lib' and hope this is the path to openmpi
-    # include files and libraries.
-    export MPI_ARCH_PATH="${libDir%/*}"
+# 64-bit on OpenSuSE 12.1 uses lib64 others use lib
+_foamAddLib     $MPI_ARCH_PATH/lib
 
-    _foamAddLib     $libDir
-    unset libDir
-    ;;
-
-OPENMPI)
-    export FOAM_MPI=openmpi-2.1.1
-    # Optional configuration tweaks:
-    _foamSource `$WM_PROJECT_DIR/bin/foamEtcFile config.sh/openmpi`
-
-    export MPI_ARCH_PATH=$WM_THIRD_PARTY_DIR/platforms/$WM_ARCH$WM_COMPILER/$FOAM_MPI
-
-    # Tell OpenMPI where to find its install directory
-    export OPAL_PREFIX=$MPI_ARCH_PATH
-
-    _foamAddPath    $MPI_ARCH_PATH/bin
-
-    # 64-bit on OpenSuSE 12.1 uses lib64 others use lib
-    _foamAddLib     $MPI_ARCH_PATH/lib$WM_COMPILER_LIB_ARCH
-    _foamAddLib     $MPI_ARCH_PATH/lib
-
-    _foamAddMan     $MPI_ARCH_PATH/share/man
-    ;;
-
-SYSTEMMPI)
-    export FOAM_MPI=mpi-system
-
-    if [ -z "$MPI_ROOT" ]
-    then
-        echo 1>&2
-        echo "Warning in $WM_PROJECT_DIR/etc/config.sh/settings:" 1>&2
-        echo "    Please set the environment variable MPI_ROOT to point to" \
-             " the base folder for the system MPI in use." 1>&2
-        echo "    Example:" 1>&2
-        echo 1>&2
-        echo "        export MPI_ROOT=/opt/mpi" 1>&2
-        echo 1>&2
-    else
-        export MPI_ARCH_PATH=$MPI_ROOT
-
-        if [ -z "$MPI_ARCH_FLAGS" ]
-        then
-            echo 1>&2
-            echo "Warning in $WM_PROJECT_DIR/etc/config.sh/settings:" 1>&2
-            echo "    MPI_ARCH_FLAGS is not set. Example:" 1>&2
-            echo 1>&2
-            echo "        export MPI_ARCH_FLAGS=\"-DOMPI_SKIP_MPICXX\"" 1>&2
-            echo 1>&2
-        fi
-
-        if [ -z "$MPI_ARCH_INC" ]
-        then
-            echo 1>&2
-            echo "Warning in $WM_PROJECT_DIR/etc/config.sh/settings:" 1>&2
-            echo "    MPI_ARCH_INC is not set. Example:" 1>&2
-            echo 1>&2
-            echo "        export MPI_ARCH_INC=\"-isystem \$MPI_ROOT/include\"" 1>&2
-            echo 1>&2
-        fi
-
-        if [ -z "$MPI_ARCH_LIBS" ]
-        then
-            echo 1>&2
-            echo "Warning in $WM_PROJECT_DIR/etc/config.sh/settings:" 1>&2
-            echo "    MPI_ARCH_LIBS is not set. Example:" 1>&2
-            echo 1>&2
-            echo "        export MPI_ARCH_LIBS=\"-L\$MPI_ROOT/lib -lmpi\"" 1>&2
-            echo 1>&2
-        fi
-    fi
-    ;;
-
-MPICH)
-    export FOAM_MPI=mpich2-1.1.1p1
-    export MPI_HOME=$WM_THIRD_PARTY_DIR/$FOAM_MPI
-    export MPI_ARCH_PATH=$WM_THIRD_PARTY_DIR/platforms/$WM_ARCH$WM_COMPILER/$FOAM_MPI
-
-    _foamAddPath    $MPI_ARCH_PATH/bin
-
-    # 64-bit on OpenSuSE 12.1 uses lib64 others use lib
-    _foamAddLib     $MPI_ARCH_PATH/lib$WM_COMPILER_LIB_ARCH
-    _foamAddLib     $MPI_ARCH_PATH/lib
-
-    _foamAddMan     $MPI_ARCH_PATH/share/man
-    ;;
-
-MPICH-GM)
-    export FOAM_MPI=mpich-gm
-    export MPI_ARCH_PATH=/opt/mpi
-    export MPICH_PATH=$MPI_ARCH_PATH
-    export GM_LIB_PATH=/opt/gm/lib64
-
-    _foamAddPath    $MPI_ARCH_PATH/bin
-
-    # 64-bit on OpenSuSE 12.1 uses lib64 others use lib
-    _foamAddLib     $MPI_ARCH_PATH/lib$WM_COMPILER_LIB_ARCH
-    _foamAddLib     $MPI_ARCH_PATH/lib
-
-    _foamAddLib     $GM_LIB_PATH
-    ;;
-
-MV2MPI)
-    export FOAM_MPI=mvapich2
-    libDir=`mpicc -show -cc= | sed -e 's/.*-L\([^ ]*\).*/\1/'`
-    export MPI_ARCH_PATH="${libDir%/*}"
-    _foamAddLib $libDir
-    unset libDir
-    ;;
-
-HPMPI)
-    export FOAM_MPI=hpmpi
-    export MPI_HOME=/opt/hpmpi
-    export MPI_ARCH_PATH=$MPI_HOME
-
-    _foamAddPath $MPI_ARCH_PATH/bin
-
-    case `uname -m` in
-    i686)
-        _foamAddLib $MPI_ARCH_PATH/lib/linux_ia32
-        ;;
-
-    x86_64)
-        _foamAddLib $MPI_ARCH_PATH/lib/linux_amd64
-        ;;
-    *)
-        echo Unknown processor type `uname -m` 1>&2
-        ;;
-    esac
-    ;;
-
-MPI)
-    export FOAM_MPI=mpi
-    export MPI_ARCH_PATH=/opt/mpi
-    ;;
-
-FJMPI)
-    export FOAM_MPI=fjmpi
-    export MPI_ARCH_PATH=/opt/FJSVmpi2
-
-    _foamAddPath    $MPI_ARCH_PATH/bin
-    _foamAddLib     $MPI_ARCH_PATH/lib/sparcv9
-    _foamAddLib     /opt/FSUNf90/lib/sparcv9
-    _foamAddLib     /opt/FJSVpnidt/lib
-    ;;
-
-QSMPI)
-    export FOAM_MPI=qsmpi
-    export MPI_ARCH_PATH=/usr/lib/mpi
-
-    _foamAddPath    $MPI_ARCH_PATH/bin
-    _foamAddLib     $MPI_ARCH_PATH/lib
-    ;;
-
-SGIMPI)
-    # No trailing slash
-    [ "${MPI_ROOT%/}" = "${MPI_ROOT}" ] || MPI_ROOT="${MPI_ROOT%/}"
-
-    export FOAM_MPI="${MPI_ROOT##*/}"
-    export MPI_ARCH_PATH=$MPI_ROOT
-
-    if [ ! -d "$MPI_ROOT" -o -z "$MPI_ARCH_PATH" ]
-    then
-        echo "Warning in $WM_PROJECT_DIR/etc/config.sh/settings:" 1>&2
-        echo "    MPI_ROOT not a valid mpt installation directory or ending" \
-             " in a '/'." 1>&2
-        echo "    Please set MPI_ROOT to the mpt installation directory." 1>&2
-        echo "    MPI_ROOT currently set to '$MPI_ROOT'" 1>&2
-    fi
-
-    if [ "$FOAM_VERBOSE" -a "$PS1" ]
-    then
-        echo "Using SGI MPT:" 1>&2
-        echo "    MPI_ROOT : $MPI_ROOT" 1>&2
-        echo "    FOAM_MPI : $FOAM_MPI" 1>&2
-    fi
-
-    _foamAddPath    $MPI_ARCH_PATH/bin
-    _foamAddLib     $MPI_ARCH_PATH/lib
-    ;;
-
-INTELMPI)
-    # No trailing slash
-    [ "${MPI_ROOT%/}" = "${MPI_ROOT}" ] || MPI_ROOT="${MPI_ROOT%/}"
-
-    export FOAM_MPI="${MPI_ROOT##*/}"
-    export MPI_ARCH_PATH=$MPI_ROOT
-
-    if [ ! -d "$MPI_ROOT" -o -z "$MPI_ARCH_PATH" ]
-    then
-        echo "Warning in $WM_PROJECT_DIR/etc/config.sh/settings:" 1>&2
-        echo "    MPI_ROOT not a valid mpt installation directory or ending" \
-             " in a '/'." 1>&2
-        echo "    Please set MPI_ROOT to the mpt installation directory." 1>&2
-        echo "    MPI_ROOT currently set to '$MPI_ROOT'" 1>&2
-    fi
-
-    if [ "$FOAM_VERBOSE" -a "$PS1" ]
-    then
-        echo "Using INTEL MPI:" 1>&2
-        echo "    MPI_ROOT : $MPI_ROOT" 1>&2
-        echo "    FOAM_MPI : $FOAM_MPI" 1>&2
-    fi
-
-    _foamAddPath    $MPI_ARCH_PATH/bin64
-    _foamAddLib     $MPI_ARCH_PATH/lib/release
-    ;;
-*)
-    export FOAM_MPI=dummy
-    ;;
-esac
+_foamAddMan     $MPI_ARCH_PATH/share/man
 
 # Add (non-dummy) MPI implementation
 # Dummy MPI already added to LD_LIBRARY_PATH and has no external libraries
diff --git a/etc/config.sh/scotch b/etc/config.sh/scotch
index a345a2d00..8883707d2 100644
--- a/etc/config.sh/scotch
+++ b/etc/config.sh/scotch
@@ -37,7 +37,7 @@
 #
 #------------------------------------------------------------------------------
 
-export SCOTCH_VERSION=scotch_6.0.9
-export SCOTCH_ARCH_PATH=$WM_THIRD_PARTY_DIR/platforms/$WM_ARCH$WM_COMPILER$WM_PRECISION_OPTION$WM_LABEL_OPTION/$SCOTCH_VERSION
+export SCOTCH_VERSION=scotch_$SCOTCHVERSION
+export SCOTCH_ARCH_PATH=$PT_SCOTCH_ROOT
 
 #------------------------------------------------------------------------------
diff --git a/etc/config.sh/settings b/etc/config.sh/settings
index d48896bac..3067d4608 100644
--- a/etc/config.sh/settings
+++ b/etc/config.sh/settings
@@ -290,6 +290,9 @@ OpenFOAM | ThirdParty)
     ;;
 system)
     # Use system compiler
+    # Use system GMP and MPFR packages
+    export GMP_ARCH_PATH=$GMP_ROOT
+    export MPFR_ARCH_PATH=$MPFR_ROOT
     ;;
 *)
     echo "Warn: WM_COMPILER_TYPE='$WM_COMPILER_TYPE' is unsupported" 1>&2
diff --git a/src/parallel/decompose/ptscotchDecomp/Make/options b/src/parallel/decompose/ptscotchDecomp/Make/options
index 2af0fddac..993f9f2aa 100644
--- a/src/parallel/decompose/ptscotchDecomp/Make/options
+++ b/src/parallel/decompose/ptscotchDecomp/Make/options
@@ -5,12 +5,11 @@ EXE_INC = \
     -I$(FOAM_SRC)/Pstream/mpi/lnInclude \
     -I$(SCOTCH_ARCH_PATH)/include/$(FOAM_MPI) \
     -I$(SCOTCH_ARCH_PATH)/include \
-    -I/usr/include/scotch \
     -I../decompositionMethods/lnInclude
 
 LIB_LIBS = \
     -L$(SCOTCH_ARCH_PATH)/lib \
-    -L$(FOAM_EXT_LIBBIN)/$(FOAM_MPI) \
+    -L$(MPI_ARCH_PATH)/lib \
     -lptscotch \
     -lptscotcherrexit \
     -lscotch \
diff --git a/src/parallel/decompose/scotchDecomp/Make/options b/src/parallel/decompose/scotchDecomp/Make/options
index 038f88d5f..f57b8ee14 100644
--- a/src/parallel/decompose/scotchDecomp/Make/options
+++ b/src/parallel/decompose/scotchDecomp/Make/options
@@ -6,12 +6,10 @@
 EXE_INC = \
     $(PFLAGS) $(PINC) \
     -I$(SCOTCH_ARCH_PATH)/include \
-    -I/usr/include/scotch \
     -I../decompositionMethods/lnInclude
 
 LIB_LIBS = \
     -L$(SCOTCH_ARCH_PATH)/lib \
-    -L$(FOAM_EXT_LIBBIN) \
     -lscotch \
     -lscotcherrexit \
     -lrt
diff --git a/src/randomProcesses/graph/writers/gnuplotGraph/gnuplotGraph.H b/src/randomProcesses/graph/writers/gnuplotGraph/gnuplotGraph.H
index 9c2df4377..95d940285 100644
--- a/src/randomProcesses/graph/writers/gnuplotGraph/gnuplotGraph.H
+++ b/src/randomProcesses/graph/writers/gnuplotGraph/gnuplotGraph.H
@@ -54,7 +54,7 @@ class gnuplotGraph
 public:
 
     //- Runtime type information
-    TypeName("gnuplot");
+    TypeName("$GNUPLOT");
 
     //- FileName extension  for this graph format
     static const word ext_;
diff --git a/src/sampling/sampledSet/writers/gnuplot/gnuplotSetWriter.H b/src/sampling/sampledSet/writers/gnuplot/gnuplotSetWriter.H
index b8e031085..f358f869d 100644
--- a/src/sampling/sampledSet/writers/gnuplot/gnuplotSetWriter.H
+++ b/src/sampling/sampledSet/writers/gnuplot/gnuplotSetWriter.H
@@ -53,7 +53,7 @@ class gnuplotSetWriter
 public:
 
     //- Runtime type information
-    TypeName("gnuplot");
+    TypeName("$GNUPLOT");
 
 
     // Constructors
diff --git a/test/multiphase/multiphaseEulerFoam/interfaceComposition/waterAndIsopropanolEvaporation/Allrun b/test/multiphase/multiphaseEulerFoam/interfaceComposition/waterAndIsopropanolEvaporation/Allrun
index 9dfacf68e..19e8a825a 100755
--- a/test/multiphase/multiphaseEulerFoam/interfaceComposition/waterAndIsopropanolEvaporation/Allrun
+++ b/test/multiphase/multiphaseEulerFoam/interfaceComposition/waterAndIsopropanolEvaporation/Allrun
@@ -31,7 +31,7 @@ do
     done
 done
 
-gnuplot << EOF
+$GNUPLOT << EOF
 
 set terminal eps enhanced size 5.83,8.27
 set output 'postProcessing.eps'
diff --git a/test/multiphase/multiphaseEulerFoam/interfaceComposition/waterEvaporation/Allrun b/test/multiphase/multiphaseEulerFoam/interfaceComposition/waterEvaporation/Allrun
index 9641b9c49..377009f46 100755
--- a/test/multiphase/multiphaseEulerFoam/interfaceComposition/waterEvaporation/Allrun
+++ b/test/multiphase/multiphaseEulerFoam/interfaceComposition/waterEvaporation/Allrun
@@ -64,7 +64,7 @@ do
     done
 done
 
-gnuplot << EOF
+$GNUPLOT << EOF
 
 set terminal eps enhanced size 5.83,8.27
 set output 'postProcessing.eps'
diff --git a/test/multiphase/multiphaseEulerFoam/populationBalance/binaryBreakup/validation/createGraphs b/test/multiphase/multiphaseEulerFoam/populationBalance/binaryBreakup/validation/createGraphs
index 673b293c7..7bfee48c3 100755
--- a/test/multiphase/multiphaseEulerFoam/populationBalance/binaryBreakup/validation/createGraphs
+++ b/test/multiphase/multiphaseEulerFoam/populationBalance/binaryBreakup/validation/createGraphs
@@ -1,12 +1,12 @@
 #!/bin/sh
 
-if ! which gnuplot > /dev/null 2>&1
+if ! which $GNUPLOT > /dev/null 2>&1
 then
     echo 'gnuplot not found - skipping graph creation' >&2
     exit 1
 fi
 
-gnuplot<<EOF
+$GNUPLOT<<EOF
     set terminal postscript eps color enhanced "Helvetica,20"
     set output '../numberDensity.eps'
     set decimalsign '.'
diff --git a/test/multiphase/multiphaseEulerFoam/populationBalance/breakup/validation/createGraphs b/test/multiphase/multiphaseEulerFoam/populationBalance/breakup/validation/createGraphs
index 673b293c7..7bfee48c3 100755
--- a/test/multiphase/multiphaseEulerFoam/populationBalance/breakup/validation/createGraphs
+++ b/test/multiphase/multiphaseEulerFoam/populationBalance/breakup/validation/createGraphs
@@ -1,12 +1,12 @@
 #!/bin/sh
 
-if ! which gnuplot > /dev/null 2>&1
+if ! which $GNUPLOT > /dev/null 2>&1
 then
     echo 'gnuplot not found - skipping graph creation' >&2
     exit 1
 fi
 
-gnuplot<<EOF
+$GNUPLOT<<EOF
     set terminal postscript eps color enhanced "Helvetica,20"
     set output '../numberDensity.eps'
     set decimalsign '.'
diff --git a/test/multiphase/multiphaseEulerFoam/populationBalance/coalescence/validation/createGraphs b/test/multiphase/multiphaseEulerFoam/populationBalance/coalescence/validation/createGraphs
index 2f9808388..fba7ed5f7 100755
--- a/test/multiphase/multiphaseEulerFoam/populationBalance/coalescence/validation/createGraphs
+++ b/test/multiphase/multiphaseEulerFoam/populationBalance/coalescence/validation/createGraphs
@@ -1,12 +1,12 @@
 #!/bin/sh
 
-if ! which gnuplot > /dev/null 2>&1
+if ! which $GNUPLOT > /dev/null 2>&1
 then
     echo 'gnuplot not found - skipping graph creation' >&2
     exit 1
 fi
 
-gnuplot<<EOF
+$GNUPLOT<<EOF
     set terminal postscript eps color enhanced "Helvetica,20"
     set output '../numberDensity.eps'
     set decimalsign '.'
diff --git a/test/multiphase/multiphaseEulerFoam/populationBalance/drift/validation/createGraphs b/test/multiphase/multiphaseEulerFoam/populationBalance/drift/validation/createGraphs
index ddb779992..b0c11ad36 100755
--- a/test/multiphase/multiphaseEulerFoam/populationBalance/drift/validation/createGraphs
+++ b/test/multiphase/multiphaseEulerFoam/populationBalance/drift/validation/createGraphs
@@ -1,12 +1,12 @@
 #!/bin/sh
 
-if ! which gnuplot > /dev/null 2>&1
+if ! which $GNUPLOT > /dev/null 2>&1
 then
     echo 'gnuplot not found - skipping graph creation' >&2
     exit 1
 fi
 
-gnuplot<<EOF
+$GNUPLOT<<EOF
     set terminal postscript eps color enhanced "Helvetica,20"
     set output '../numberDensity.eps'
     set decimalsign '.'
diff --git a/test/multiphase/multiphaseEulerFoam/populationBalance/isothermalGrowth/validation/createGraphs b/test/multiphase/multiphaseEulerFoam/populationBalance/isothermalGrowth/validation/createGraphs
index 843ccf677..923932605 100755
--- a/test/multiphase/multiphaseEulerFoam/populationBalance/isothermalGrowth/validation/createGraphs
+++ b/test/multiphase/multiphaseEulerFoam/populationBalance/isothermalGrowth/validation/createGraphs
@@ -1,12 +1,12 @@
 #!/bin/sh
 
-if ! which gnuplot > /dev/null 2>&1
+if ! which $GNUPLOT > /dev/null 2>&1
 then
     echo 'gnuplot not found - skipping graph creation' >&2
     exit 1
 fi
 
-gnuplot<<EOF
+$GNUPLOT<<EOF
     set terminal postscript eps color enhanced "Helvetica,20"
     set output '../d.air_y.eps'
 
diff --git a/test/multiphase/multiphaseEulerFoam/populationBalance/negativeDrift/validation/createGraphs b/test/multiphase/multiphaseEulerFoam/populationBalance/negativeDrift/validation/createGraphs
index bae86a939..6047f55d3 100755
--- a/test/multiphase/multiphaseEulerFoam/populationBalance/negativeDrift/validation/createGraphs
+++ b/test/multiphase/multiphaseEulerFoam/populationBalance/negativeDrift/validation/createGraphs
@@ -1,12 +1,12 @@
 #!/bin/sh
 
-if ! which gnuplot > /dev/null 2>&1
+if ! which $GNUPLOT > /dev/null 2>&1
 then
     echo 'gnuplot not found - skipping graph creation' >&2
     exit 1
 fi
 
-gnuplot<<EOF
+$GNUPLOT<<EOF
     set terminal postscript eps color enhanced "Helvetica,20"
     set output '../numberDensity.eps'
     set decimalsign '.'
diff --git a/test/multiphase/multiphaseEulerFoam/populationBalance/simultaneousCoalescenceAndBreakup/validation/createGraphs b/test/multiphase/multiphaseEulerFoam/populationBalance/simultaneousCoalescenceAndBreakup/validation/createGraphs
index da0e70401..7840728f5 100755
--- a/test/multiphase/multiphaseEulerFoam/populationBalance/simultaneousCoalescenceAndBreakup/validation/createGraphs
+++ b/test/multiphase/multiphaseEulerFoam/populationBalance/simultaneousCoalescenceAndBreakup/validation/createGraphs
@@ -1,12 +1,12 @@
 #!/bin/sh
 
-if ! which gnuplot > /dev/null 2>&1
+if ! which $GNUPLOT > /dev/null 2>&1
 then
     echo 'gnuplot not found - skipping graph creation' >&2
     exit 1
 fi
 
-gnuplot<<EOF
+$GNUPLOT<<EOF
     set terminal postscript eps color enhanced "Helvetica,20"
     set output '../probabilityDensity.eps'
     set decimalsign '.'
diff --git a/test/multiphase/multiphaseEulerFoam/thermal/waterEvaporation/Allrun b/test/multiphase/multiphaseEulerFoam/thermal/waterEvaporation/Allrun
index 432ac9f2b..3a789aef0 100755
--- a/test/multiphase/multiphaseEulerFoam/thermal/waterEvaporation/Allrun
+++ b/test/multiphase/multiphaseEulerFoam/thermal/waterEvaporation/Allrun
@@ -38,7 +38,7 @@ do
     done
 done
 
-gnuplot << EOF
+$GNUPLOT << EOF
 
 set terminal eps enhanced size 5.83,8.27
 set output 'postProcessing.eps'
diff --git a/tutorials/combustion/chemFoam/gri/validation/createGraph b/tutorials/combustion/chemFoam/gri/validation/createGraph
index d0fb9cc01..f3a350f24 100755
--- a/tutorials/combustion/chemFoam/gri/validation/createGraph
+++ b/tutorials/combustion/chemFoam/gri/validation/createGraph
@@ -1,12 +1,12 @@
 #!/bin/sh
 
-if ! which gnuplot > /dev/null 2>&1
+if ! which $GNUPLOT > /dev/null 2>&1
 then
     echo "gnuplot not found - skipping graph creation" >&2
     exit 1
 fi
 
-gnuplot<<EOF
+$GNUPLOT<<EOF
     set terminal postscript eps color enhanced "Helveicta,20"
     set output "OF_vs_CHEMKINII.eps"
     set xlabel "Time / [s]" font "Helveicta,24"
diff --git a/tutorials/combustion/chemFoam/h2/validation/createGraph b/tutorials/combustion/chemFoam/h2/validation/createGraph
index bbb36218f..0fc008261 100755
--- a/tutorials/combustion/chemFoam/h2/validation/createGraph
+++ b/tutorials/combustion/chemFoam/h2/validation/createGraph
@@ -1,12 +1,12 @@
 #!/bin/sh
 
-if ! which gnuplot > /dev/null 2>&1
+if ! which $GNUPLOT > /dev/null 2>&1
 then
     echo "gnuplot not found - skipping graph creation" >&2
     exit 1
 fi
 
-gnuplot<<EOF
+$GNUPLOT<<EOF
     set terminal postscript eps color enhanced "Helvetica,20"
     set output "OF_vs_CHEMKINII.eps"
     set xlabel "Time / [s]" font "Helvetica,24"
diff --git a/tutorials/combustion/chemFoam/ic8h18/validation/createGraph b/tutorials/combustion/chemFoam/ic8h18/validation/createGraph
index 4606eac7d..43af24856 100755
--- a/tutorials/combustion/chemFoam/ic8h18/validation/createGraph
+++ b/tutorials/combustion/chemFoam/ic8h18/validation/createGraph
@@ -1,12 +1,12 @@
 #!/bin/sh
 
-if ! which gnuplot > /dev/null 2>&1
+if ! which $GNUPLOT > /dev/null 2>&1
 then
     echo "gnuplot not found - skipping graph creation" >&2
     exit 1
 fi
 
-gnuplot<<EOF
+$GNUPLOT<<EOF
     set terminal postscript eps color enhanced "Helvetica,20"
     set output "OF_vs_CHEMKINII.eps"
     set xlabel "Time / [s]" font "Helvetica,24"
diff --git a/tutorials/combustion/chemFoam/ic8h18_TDAC/validation/createGraph b/tutorials/combustion/chemFoam/ic8h18_TDAC/validation/createGraph
index 901919282..218212998 100755
--- a/tutorials/combustion/chemFoam/ic8h18_TDAC/validation/createGraph
+++ b/tutorials/combustion/chemFoam/ic8h18_TDAC/validation/createGraph
@@ -1,12 +1,12 @@
 #!/bin/sh
 
-if ! which gnuplot > /dev/null 2>&1
+if ! which $GNUPLOT > /dev/null 2>&1
 then
     echo "gnuplot not found - skipping graph creation" >&2
     exit 1
 fi
 
-gnuplot<<EOF
+$GNUPLOT<<EOF
     set terminal postscript eps color enhanced "Helvetica,20"
     set output "OF_vs_CHEMKINII.eps"
     set xlabel "Time / [s]" font "Helvetica,24"
diff --git a/tutorials/combustion/chemFoam/nc7h16/validation/createGraph b/tutorials/combustion/chemFoam/nc7h16/validation/createGraph
index b2f8a4d94..ad074b8e2 100755
--- a/tutorials/combustion/chemFoam/nc7h16/validation/createGraph
+++ b/tutorials/combustion/chemFoam/nc7h16/validation/createGraph
@@ -1,12 +1,12 @@
 #!/bin/sh
 
-if ! which gnuplot > /dev/null 2>&1
+if ! which $GNUPLOT > /dev/null 2>&1
 then
     echo "gnuplot not found - skipping graph creation" >&2
     exit 1
 fi
 
-gnuplot<<EOF
+$GNUPLOT<<EOF
     set terminal postscript eps color enhanced "Helvetica,20"
     set output "OF_vs_CHEMKINII.eps"
     set xlabel "Time / [s]" font "Helvetica,24"
diff --git a/tutorials/compressible/rhoPimpleFoam/laminar/helmholtzResonance/Allrun b/tutorials/compressible/rhoPimpleFoam/laminar/helmholtzResonance/Allrun
index 6557c1075..5219a3efb 100755
--- a/tutorials/compressible/rhoPimpleFoam/laminar/helmholtzResonance/Allrun
+++ b/tutorials/compressible/rhoPimpleFoam/laminar/helmholtzResonance/Allrun
@@ -31,7 +31,7 @@ run resolved
 run modelled
 
 # Plot a comparison of the pressure in the neck
-cat << EOF | gnuplot -persist
+cat << EOF | $GNUPLOT -persist
 
 set terminal postscript eps size 5,4 enhanced color
 
diff --git a/tutorials/heatTransfer/buoyantFoam/buoyantCavity/validation/createGraphs b/tutorials/heatTransfer/buoyantFoam/buoyantCavity/validation/createGraphs
index 625b87946..ba4cf4670 100755
--- a/tutorials/heatTransfer/buoyantFoam/buoyantCavity/validation/createGraphs
+++ b/tutorials/heatTransfer/buoyantFoam/buoyantCavity/validation/createGraphs
@@ -42,7 +42,7 @@ createEpsT()
     OF=$2
     EXPT=$3
 
-    gnuplot<<EOF
+    $GNUPLOT<<EOF
     set terminal postscript eps color enhanced
     set output "OF_vs_EXPT_T$i.eps"
     set xlabel "Channel width, x / [m]"
@@ -66,7 +66,7 @@ createEpsU()
     OF=$2
     EXPT=$3
 
-    gnuplot<<EOF
+    $GNUPLOT<<EOF
     set terminal postscript eps color enhanced
     set output "OF_vs_EXPT_U$i.eps"
     set xlabel "Channel width, x / [m]"
@@ -86,7 +86,7 @@ EOF
 echo "createGraphs:"
 
 # test if gnuplot exists on the system
-if ! which gnuplot > /dev/null 2>&1
+if ! which $GNUPLOT > /dev/null 2>&1
 then
     echo "FOAM FATAL ERROR: gnuplot not found - skipping graph creation" >&2
     exit 1
diff --git a/tutorials/incompressible/boundaryFoam/boundaryWallFunctionsProfile/Allrun b/tutorials/incompressible/boundaryFoam/boundaryWallFunctionsProfile/Allrun
index 98d5a8635..4ff7fa9e9 100755
--- a/tutorials/incompressible/boundaryFoam/boundaryWallFunctionsProfile/Allrun
+++ b/tutorials/incompressible/boundaryFoam/boundaryWallFunctionsProfile/Allrun
@@ -37,7 +37,7 @@ done
 
 # create validation plot
 # test if gnuplot exists on the system
-if ! which gnuplot > /dev/null 2>&1
+if ! which $GNUPLOT > /dev/null 2>&1
 then
     echo "gnuplot not found - skipping graph creation" >&2
     exit 1
@@ -46,7 +46,7 @@ fi
 graphName="OF_vs_ANALYTICAL.eps"
 
 echo "Creating graph of u+ vs y+ to $graphName"
-gnuplot<<EOF
+$GNUPLOT<<EOF
     set terminal postscript eps color enhanced
     set output "$graphName"
     set grid
diff --git a/tutorials/incompressible/pimpleFoam/RAS/ballValve/createGraphs b/tutorials/incompressible/pimpleFoam/RAS/ballValve/createGraphs
index 57e466f77..9f078e6d3 100755
--- a/tutorials/incompressible/pimpleFoam/RAS/ballValve/createGraphs
+++ b/tutorials/incompressible/pimpleFoam/RAS/ballValve/createGraphs
@@ -6,7 +6,7 @@ inletFlowRate=postProcessing/inletFlowRate/0/surfaceFieldValue.dat
 lowerOutletFlowRate=postProcessing/lowerOutletFlowRate/0/surfaceFieldValue.dat
 upperOutletFlowRate=postProcessing/upperOutletFlowRate/0/surfaceFieldValue.dat
 
-gnuplot << EOF
+$GNUPLOT << EOF
 set terminal postscript eps color enhanced
 set output "flowRate.eps"
 set xlabel "Time (s)"
@@ -19,7 +19,7 @@ plot \
     us 1:(\$2+\$4) w l t "Total Outlet"
 EOF
 
-gnuplot << EOF
+$GNUPLOT << EOF
 set terminal postscript eps color enhanced
 set output "error.eps"
 set xlabel "Time (s)"
diff --git a/tutorials/incompressible/pimpleFoam/laminar/nonConformalChannel/Allrun b/tutorials/incompressible/pimpleFoam/laminar/nonConformalChannel/Allrun
index 970f45e67..e9524165e 100755
--- a/tutorials/incompressible/pimpleFoam/laminar/nonConformalChannel/Allrun
+++ b/tutorials/incompressible/pimpleFoam/laminar/nonConformalChannel/Allrun
@@ -33,7 +33,7 @@ outletFlowRateAMI=postProcessing/outletFlowRate.AMI/0/surfaceFieldValue.dat
 inletFlowRateNonConformalCyclic=postProcessing/inletFlowRate.nonConformalCyclic/0/surfaceFieldValue.dat
 outletFlowRateNonConformalCyclic=postProcessing/outletFlowRate.nonConformalCyclic/0/surfaceFieldValue.dat
 
-gnuplot << EOF
+$GNUPLOT << EOF
 set terminal postscript eps color enhanced
 set output "error.eps"
 set xlabel "Time (s)"
diff --git a/tutorials/incompressible/pimpleFoam/laminar/planarPoiseuille/validation/createGraph b/tutorials/incompressible/pimpleFoam/laminar/planarPoiseuille/validation/createGraph
index 53fee3647..06df26399 100755
--- a/tutorials/incompressible/pimpleFoam/laminar/planarPoiseuille/validation/createGraph
+++ b/tutorials/incompressible/pimpleFoam/laminar/planarPoiseuille/validation/createGraph
@@ -3,13 +3,13 @@
 tail -n +4 ../postProcessing/probes/0/U  | \
     tr -s " " | tr -d '(' | cut -d " " -f1-2 > ../Numerical.dat
 
-if ! which gnuplot > /dev/null 2>&1
+if ! which $GNUPLOT > /dev/null 2>&1
 then
     echo "gnuplot not found - skipping graph creation" >&2
     exit 1
 fi
 
-gnuplot<<EOF
+$GNUPLOT<<EOF
     set terminal postscript eps color enhanced "Helvetica,20"
     set output "planarPoiseuille.eps"
     set xlabel "Time / [s]" font "Helvetica,24"
diff --git a/tutorials/incompressible/simpleFoam/T3A/validation/createGraphs b/tutorials/incompressible/simpleFoam/T3A/validation/createGraphs
index e7a91615f..71b8d5f27 100755
--- a/tutorials/incompressible/simpleFoam/T3A/validation/createGraphs
+++ b/tutorials/incompressible/simpleFoam/T3A/validation/createGraphs
@@ -1,6 +1,6 @@
 #!/bin/sh
 
-if ! which gnuplot > /dev/null 2>&1
+if ! which $GNUPLOT > /dev/null 2>&1
 then
     echo "gnuplot not found - skipping graph creation" >&2
     exit 1
@@ -8,7 +8,7 @@ fi
 
 time=$(foamListTimes -case .. -latestTime)
 
-gnuplot<<EOF
+$GNUPLOT<<EOF
     set term post enhanced color solid linewidth 2.0 20
     set out "graphs.eps"
     set encoding utf8
diff --git a/tutorials/incompressible/simpleFoam/roomResidenceTime/validation/Allrun b/tutorials/incompressible/simpleFoam/roomResidenceTime/validation/Allrun
index 9bf0240c8..914728a93 100755
--- a/tutorials/incompressible/simpleFoam/roomResidenceTime/validation/Allrun
+++ b/tutorials/incompressible/simpleFoam/roomResidenceTime/validation/Allrun
@@ -32,6 +32,6 @@ done < "ageValues"
 paste positionsZ ageDimless2 > Pos2_OF
 
 # ------ Plot the results
-gnuplot plot*
+$GNUPLOT plot*
 
 #------------------------------------------------------------------------------
diff --git a/tutorials/mesh/snappyHexMesh/iglooWithFridges b/tutorials/mesh/snappyHexMesh/iglooWithFridges
index 3d18de2c2..ef42b45b3 120000
--- a/tutorials/mesh/snappyHexMesh/iglooWithFridges
+++ b/tutorials/mesh/snappyHexMesh/iglooWithFridges
@@ -1 +1 @@
-../../heatTransfer/buoyantSimpleFoam/iglooWithFridges
\ No newline at end of file
+../../heatTransfer/buoyantFoam/iglooWithFridges
\ No newline at end of file
diff --git a/tutorials/multiphase/multiphaseEulerFoam/RAS/Grossetete/validation/createGraphs b/tutorials/multiphase/multiphaseEulerFoam/RAS/Grossetete/validation/createGraphs
index 69e308bbf..e768b6c84 100755
--- a/tutorials/multiphase/multiphaseEulerFoam/RAS/Grossetete/validation/createGraphs
+++ b/tutorials/multiphase/multiphaseEulerFoam/RAS/Grossetete/validation/createGraphs
@@ -1,12 +1,12 @@
 #!/bin/sh
 
-if ! which gnuplot > /dev/null 2>&1
+if ! which $GNUPLOT > /dev/null 2>&1
 then
     echo 'gnuplot not found - skipping graph creation' >&2
     exit 1
 fi
 
-gnuplot<<EOF
+$GNUPLOT<<EOF
     set terminal postscript eps color enhanced font "Helvetica,20"
     set output '../void_fraction.eps'
 
diff --git a/tutorials/multiphase/multiphaseEulerFoam/RAS/bubblePipe/validation/createGraphs b/tutorials/multiphase/multiphaseEulerFoam/RAS/bubblePipe/validation/createGraphs
index 354f3bbc1..7251cd4f8 100755
--- a/tutorials/multiphase/multiphaseEulerFoam/RAS/bubblePipe/validation/createGraphs
+++ b/tutorials/multiphase/multiphaseEulerFoam/RAS/bubblePipe/validation/createGraphs
@@ -1,6 +1,6 @@
 #!/bin/sh
 
-if ! which gnuplot > /dev/null 2>&1
+if ! which $GNUPLOT > /dev/null 2>&1
 then
     echo 'gnuplot not found - skipping graph creation' >&2
     exit 1
@@ -10,7 +10,7 @@ time=$(foamListTimes -case .. -latestTime)
 
 graphFile=../postProcessing/graph/$time/line.xy
 
-gnuplot<<EOF
+$GNUPLOT<<EOF
     set terminal postscript eps color enhanced font "Helvetica,20"
 
     set output '../void_fraction.eps'
@@ -34,7 +34,7 @@ EOF
 injectionFile=../postProcessing/probabilityDensity.injection/$time/probabilityDensity.injection.xy
 outletFile=../postProcessing/probabilityDensity.outlet/$time/probabilityDensity.outlet.xy
 
-gnuplot<<EOF
+$GNUPLOT<<EOF
     set terminal postscript eps color enhanced font "Helvetica,20"
 
     set output '../volumeDensity.eps'
diff --git a/tutorials/multiphase/multiphaseEulerFoam/RAS/pipeBend/validation/createGraphs b/tutorials/multiphase/multiphaseEulerFoam/RAS/pipeBend/validation/createGraphs
index 87f35b9ac..495a70746 100755
--- a/tutorials/multiphase/multiphaseEulerFoam/RAS/pipeBend/validation/createGraphs
+++ b/tutorials/multiphase/multiphaseEulerFoam/RAS/pipeBend/validation/createGraphs
@@ -1,6 +1,6 @@
 #!/bin/sh
 
-if ! which gnuplot > /dev/null 2>&1
+if ! which $GNUPLOT > /dev/null 2>&1
 then
     echo 'gnuplot not found - skipping graph creation' >&2
     exit 1
@@ -15,7 +15,7 @@ afterBend7D=../postProcessing/probabilityDensity.afterBend_7d/$time/probabilityD
 afterBend9D=../postProcessing/probabilityDensity.afterBend_9d/$time/probabilityDensity.afterBend_9d.xy
 layerAverage=../postProcessing/graphCrossSection/$time/layerAverage.xy
 
-gnuplot<<EOF
+$GNUPLOT<<EOF
     set terminal postscript eps color enhanced font "Helvetica,20"
 
     set output '../volumeDensity.eps'
@@ -31,7 +31,7 @@ gnuplot<<EOF
          "$afterBend9D" u (\$1*1e6):(\$2) w histeps lw 3 lc rgb 'blue' t 'After bend: 9D'
 EOF
 
-gnuplot<<EOF
+$GNUPLOT<<EOF
     set terminal postscript eps color enhanced font "Helvetica,20"
 
     set output '../crossSectionAverageDiameter.eps'
diff --git a/tutorials/multiphase/multiphaseEulerFoam/RAS/wallBoiling/validation/createGraphs b/tutorials/multiphase/multiphaseEulerFoam/RAS/wallBoiling/validation/createGraphs
index a33e21dec..21ae8273c 100755
--- a/tutorials/multiphase/multiphaseEulerFoam/RAS/wallBoiling/validation/createGraphs
+++ b/tutorials/multiphase/multiphaseEulerFoam/RAS/wallBoiling/validation/createGraphs
@@ -1,6 +1,6 @@
 #!/bin/sh
 
-if ! which gnuplot > /dev/null 2>&1
+if ! which $GNUPLOT > /dev/null 2>&1
 then
     echo 'gnuplot not found - skipping graph creation' >&2
     exit 1
@@ -9,7 +9,7 @@ fi
 graphFile=$(foamListTimes -latestTime)/line.xy
 surfaceFile=$(cd postProcessing/inflow && ls -1tr */* | tail -n 1)
 
-gnuplot<<EOF
+$GNUPLOT<<EOF
 
     set terminal postscript eps size 8,9 color enhanced font "Helvetica,20"
     set output "./validation/$(basename "$PWD").eps"
diff --git a/tutorials/multiphase/multiphaseEulerFoam/RAS/wallBoilingIATE/validation/createGraphs b/tutorials/multiphase/multiphaseEulerFoam/RAS/wallBoilingIATE/validation/createGraphs
index dcfceca79..d1ae68f9c 100755
--- a/tutorials/multiphase/multiphaseEulerFoam/RAS/wallBoilingIATE/validation/createGraphs
+++ b/tutorials/multiphase/multiphaseEulerFoam/RAS/wallBoilingIATE/validation/createGraphs
@@ -1,6 +1,6 @@
 #!/bin/sh
 
-if ! which gnuplot > /dev/null 2>&1
+if ! which $GNUPLOT > /dev/null 2>&1
 then
     echo 'gnuplot not found - skipping graph creation' >&2
     exit 1
@@ -9,7 +9,7 @@ fi
 graphFile=$(foamListTimes -latestTime)/line.xy
 surfaceFile=$(cd postProcessing/inflow && ls -1tr */* | tail -n 1)
 
-gnuplot<<EOF
+$GNUPLOT<<EOF
 
     set terminal postscript eps size 8,9 color enhanced font "Helvetica,20"
     set output "./validation/$(basename "$PWD").eps"
diff --git a/tutorials/multiphase/multiphaseEulerFoam/RAS/wallBoilingPolydisperse/validation/createGraphs b/tutorials/multiphase/multiphaseEulerFoam/RAS/wallBoilingPolydisperse/validation/createGraphs
index dcfceca79..d1ae68f9c 100755
--- a/tutorials/multiphase/multiphaseEulerFoam/RAS/wallBoilingPolydisperse/validation/createGraphs
+++ b/tutorials/multiphase/multiphaseEulerFoam/RAS/wallBoilingPolydisperse/validation/createGraphs
@@ -1,6 +1,6 @@
 #!/bin/sh
 
-if ! which gnuplot > /dev/null 2>&1
+if ! which $GNUPLOT > /dev/null 2>&1
 then
     echo 'gnuplot not found - skipping graph creation' >&2
     exit 1
@@ -9,7 +9,7 @@ fi
 graphFile=$(foamListTimes -latestTime)/line.xy
 surfaceFile=$(cd postProcessing/inflow && ls -1tr */* | tail -n 1)
 
-gnuplot<<EOF
+$GNUPLOT<<EOF
 
     set terminal postscript eps size 8,9 color enhanced font "Helvetica,20"
     set output "./validation/$(basename "$PWD").eps"
diff --git a/tutorials/multiphase/multiphaseEulerFoam/RAS/wallBoilingPolydisperseTwoGroups/validation/createGraphs b/tutorials/multiphase/multiphaseEulerFoam/RAS/wallBoilingPolydisperseTwoGroups/validation/createGraphs
index 82a2a0364..0e4870fdb 100755
--- a/tutorials/multiphase/multiphaseEulerFoam/RAS/wallBoilingPolydisperseTwoGroups/validation/createGraphs
+++ b/tutorials/multiphase/multiphaseEulerFoam/RAS/wallBoilingPolydisperseTwoGroups/validation/createGraphs
@@ -1,6 +1,6 @@
 #!/bin/sh
 
-if ! which gnuplot > /dev/null 2>&1
+if ! which $GNUPLOT > /dev/null 2>&1
 then
     echo 'gnuplot not found - skipping graph creation' >&2
     exit 1
@@ -9,7 +9,7 @@ fi
 graphFile=$(foamListTimes -latestTime)/line.xy
 surfaceFile=$(cd postProcessing/inflow && ls -1tr */* | tail -n 1)
 
-gnuplot<<EOF
+$GNUPLOT<<EOF
 
     set terminal postscript eps size 8,9 color enhanced font "Helvetica,20"
     set output "./validation/$(basename "$PWD").eps"
diff --git a/tutorials/multiphase/multiphaseEulerFoam/laminar/titaniaSynthesis/validation/createGraphs b/tutorials/multiphase/multiphaseEulerFoam/laminar/titaniaSynthesis/validation/createGraphs
index e93c7d850..16094a6a1 100755
--- a/tutorials/multiphase/multiphaseEulerFoam/laminar/titaniaSynthesis/validation/createGraphs
+++ b/tutorials/multiphase/multiphaseEulerFoam/laminar/titaniaSynthesis/validation/createGraphs
@@ -1,6 +1,6 @@
 #!/bin/sh
 
-if ! which gnuplot > /dev/null 2>&1
+if ! which $GNUPLOT > /dev/null 2>&1
 then
     echo 'gnuplot not found - skipping graph creation' >&2
     exit 1
@@ -10,7 +10,7 @@ time=$(foamListTimes -case .. -latestTime)
 
 graphFile=../postProcessing/graph/$time/line.xy
 
-gnuplot<<EOF
+$GNUPLOT<<EOF
     set terminal postscript eps color enhanced font "Helvetica,20"
     set output '../species.eps'
 
@@ -29,7 +29,7 @@ EOF
 
 resultFile=../postProcessing/numberDensity/$time/numberDensity.xy
 
-gnuplot<<EOF
+$GNUPLOT<<EOF
     set terminal postscript eps color enhanced font "Helvetica,20"
     set output '../sizeDistribution.eps'
 
diff --git a/tutorials/multiphase/multiphaseEulerFoam/laminar/titaniaSynthesisSurface/validation/createGraphs b/tutorials/multiphase/multiphaseEulerFoam/laminar/titaniaSynthesisSurface/validation/createGraphs
index e93c7d850..d9c4b668c 100755
--- a/tutorials/multiphase/multiphaseEulerFoam/laminar/titaniaSynthesisSurface/validation/createGraphs
+++ b/tutorials/multiphase/multiphaseEulerFoam/laminar/titaniaSynthesisSurface/validation/createGraphs
@@ -1,6 +1,6 @@
 #!/bin/sh
 
-if ! which gnuplot > /dev/null 2>&1
+if ! which $GNUPLOT > /dev/null 2>&1
 then
     echo 'gnuplot not found - skipping graph creation' >&2
     exit 1
@@ -10,7 +10,7 @@ time=$(foamListTimes -case .. -latestTime)
 
 graphFile=../postProcessing/graph/$time/line.xy
 
-gnuplot<<EOF
+$GNUPLOTt<<EOF
     set terminal postscript eps color enhanced font "Helvetica,20"
     set output '../species.eps'
 
@@ -29,7 +29,7 @@ EOF
 
 resultFile=../postProcessing/numberDensity/$time/numberDensity.xy
 
-gnuplot<<EOF
+$GNUPLOT<<EOF
     set terminal postscript eps color enhanced font "Helvetica,20"
     set output '../sizeDistribution.eps'
 
diff --git a/wmake/rules/General/CGAL b/wmake/rules/General/CGAL
index 4c574c283..1c6d3b55d 100644
--- a/wmake/rules/General/CGAL
+++ b/wmake/rules/General/CGAL
@@ -8,7 +8,7 @@ CGAL_INC = \
     $(if $(CGAL_ARCH_PATH),-I$(CGAL_ARCH_PATH)/include,-I/usr/include)
 
 CGAL_LIBS = \
-    $(if $(GMP_ARCH_PATH),-L$(GMP_ARCH_PATH)/lib$(WM_COMPILER_LIB_ARCH),) \
+    $(if $(GMP_ARCH_PATH),-L$(GMP_ARCH_PATH)/lib,) \
     -lgmp \
-    $(if $(MPFR_ARCH_PATH),-L$(MPFR_ARCH_PATH)/lib$(WM_COMPILER_LIB_ARCH),) \
+    $(if $(MPFR_ARCH_PATH),-L$(MPFR_ARCH_PATH)/lib,) \
     -lmpfr
diff --git a/wmake/rules/linux64Gcc/c++ b/wmake/rules/linux64Gcc/c++
index 9ba6ce377..3ced6c9fb 100644
--- a/wmake/rules/linux64Gcc/c++
+++ b/wmake/rules/linux64Gcc/c++
@@ -22,8 +22,8 @@ cpptoo      = $(Ctoo)
 
 LINK_LIBS   = $(c++DBUG)
 
-LINKLIBSO   = $(CC) $(c++FLAGS) -fuse-ld=bfd -shared \
+LINKLIBSO   = $(CC) $(c++FLAGS) $(LDFLAGS) -fuse-ld=bfd -shared \
               -Xlinker --add-needed -Xlinker --no-as-needed
 
-LINKEXE     = $(CC) $(c++FLAGS) -fuse-ld=bfd \
+LINKEXE     = $(CC) $(c++FLAGS) $(LDFLAGS) -fuse-ld=bfd \
               -Xlinker --add-needed -Xlinker --no-as-needed
-- 
2.38.1

